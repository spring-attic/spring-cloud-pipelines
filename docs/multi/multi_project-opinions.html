<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>4.&nbsp;Project opinions</title><link rel="stylesheet" type="text/css" href="css/manual-multipage.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="multi_spring-cloud-pipelines.html" title="Spring Cloud Pipelines"><link rel="up" href="multi_spring-cloud-pipelines.html" title="Spring Cloud Pipelines"><link rel="prev" href="multi__opinionated_implementation.html" title="3.&nbsp;Opinionated implementation"><link rel="next" href="multi__customizing_the_project.html" title="5.&nbsp;Customizing the project"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">4.&nbsp;Project opinions</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="multi__opinionated_implementation.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="multi__customizing_the_project.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="project-opinions" href="#project-opinions"></a>4.&nbsp;Project opinions</h1></div></div></div><p>In this section we will go through the assumptions we&#8217;ve made in the project
structure and project properties.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_cloud_foundry_project_opinions" href="#_cloud_foundry_project_opinions"></a>4.1&nbsp;Cloud Foundry project opinions</h2></div></div></div><p>We&#8217;ve taken the following opinionated decisions for a Cloud Foundry based project:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">application built using Maven or Gradle wrappers</li><li class="listitem">application deployment to Cloud Foundry</li><li class="listitem">you application needs a <code class="literal">manifest.yml</code> Cloud Foundry descriptor</li><li class="listitem"><p class="simpara">For Maven (<a class="link" href="https://github.com/spring-cloud-samples/github-webhook" target="_top">example project</a>):</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">usage of Maven Wrapper</li><li class="listitem"><p class="simpara"><code class="literal">settings.xml</code> is parametrized to pass the credentials to push code to Artifactory</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><code class="literal">M2_SETTINGS_REPO_ID</code> - server id for Artifactory / Nexus deployment</li><li class="listitem"><code class="literal">M2_SETTINGS_REPO_USERNAME</code> - username for Artifactory / Nexus deployment</li><li class="listitem"><code class="literal">M2_SETTINGS_REPO_PASSWORD</code> - password for Artifactory / Nexus deployment</li></ul></div></li><li class="listitem">artifacts deployment by <code class="literal">./mvnw clean deploy</code></li><li class="listitem"><code class="literal">stubrunner.ids</code> property to retrieve list of collaborators for which stubs should be downloaded</li><li class="listitem"><code class="literal">repo.with.binaries</code> property - (Injected by the pipeline) will contain the URL to the repo containing binaries (e.g. Artifactory)</li><li class="listitem"><code class="literal">distribution.management.release.id</code> property - (Injected by the pipeline) ID of the distribution management. Corresponds to server id in <code class="literal">settings.xml</code></li><li class="listitem"><code class="literal">distribution.management.release.url</code> property - (Injected by the pipeline) Will contain the URL to the repo containing binaries (e.g. Artifactory)</li><li class="listitem">running API compatibility tests via the <code class="literal">apicompatibility</code> Maven profile</li><li class="listitem"><code class="literal">latest.production.version</code> property - (Injected by the pipeline) will contain the latest production version for the repo (retrieved from Git tags)</li><li class="listitem">running smoke tests on a deployed app via the <code class="literal">smoke</code> Maven profile</li><li class="listitem">running end to end tests on a deployed app via the <code class="literal">e2e</code> Maven profile</li></ul></div></li><li class="listitem"><p class="simpara">For Gradle  (<a class="link" href="https://github.com/spring-cloud-samples/github-analytics" target="_top">example project</a> check the <code class="literal">gradle/pipeline.gradle</code> file):</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">usage of Gradlew Wrapper</li><li class="listitem"><code class="literal">deploy</code> task for artifacts deployment</li><li class="listitem"><code class="literal">REPO_WITH_BINARIES_FOR_UPLOAD</code> env var - (Injected by the pipeline) will contain the URL to the repo containing binaries (e.g. Artifactory)</li><li class="listitem"><code class="literal">M2_SETTINGS_REPO_USERNAME</code> env var - Username used to send the binary to the repo containing binaries (e.g. Artifactory)</li><li class="listitem"><code class="literal">M2_SETTINGS_REPO_PASSWORD</code> env var - Password used to send the binary to the repo containing binaries (e.g. Artifactory)</li><li class="listitem">running API compatibility tests via the <code class="literal">apiCompatibility</code> task</li><li class="listitem"><code class="literal">latestProductionVersion</code> property - (Injected by the pipeline) will contain the latest production version for the repo (retrieved from Git tags)</li><li class="listitem">running smoke tests on a deployed app via the <code class="literal">smoke</code> task</li><li class="listitem">running end to end tests on a deployed app via the <code class="literal">e2e</code> task</li><li class="listitem"><code class="literal">groupId</code> task to retrieve group id</li><li class="listitem"><code class="literal">artifactId</code> task to retrieve artifact id</li><li class="listitem"><code class="literal">currentVersion</code> task to retrieve the current version</li><li class="listitem"><code class="literal">stubIds</code> task to retrieve list of collaborators for which stubs should be downloaded</li></ul></div></li><li class="listitem"><p class="simpara">For PHP (<a class="link" href="https://github.com/spring-cloud-samples/cf-php-example" target="_top">example project</a>):</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">usage of <a class="link" href="https://getcomposer.org/" target="_top">Composer</a></li><li class="listitem"><code class="literal">composer install</code> is called to fetch libraries</li><li class="listitem"><p class="simpara">the whole application is compressed to <code class="literal">tar.gz</code> and uploaded to binary storage</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><code class="literal">REPO_WITH_BINARIES_FOR_UPLOAD</code> env var - (Injected by the pipeline) will contain the URL to the repo containing binaries (e.g. Artifactory)</li><li class="listitem"><code class="literal">M2_SETTINGS_REPO_USERNAME</code> env var - Username used to send the binary to the repo containing binaries (e.g. Artifactory)</li><li class="listitem"><code class="literal">M2_SETTINGS_REPO_PASSWORD</code> env var - Password used to send the binary to the repo containing binaries (e.g. Artifactory)</li></ul></div></li><li class="listitem"><code class="literal">group-id</code> Composer task that echos the group id</li><li class="listitem"><code class="literal">app-name</code> Composer task that echos application name</li><li class="listitem"><code class="literal">stub-ids</code> Composer task that echos stub runner ids</li><li class="listitem"><code class="literal">test-apicompatibility</code> Composer task that is executed for api compatibility tests</li><li class="listitem"><code class="literal">test-smoke</code> Composer task that is executed for smoke testing (<code class="literal">APPLICATION_URL</code> and <code class="literal">STUBRUNNER_URL</code> env vars are available here to be used)</li><li class="listitem"><code class="literal">test-e2e</code> Composer task that is executed for end to end testing (<code class="literal">APPLICATION_URL</code> env vars is available here to be used)</li><li class="listitem"><code class="literal">target</code> is assumed to be the output folder. Put it to <code class="literal">.gitignore</code></li></ul></div></li><li class="listitem"><p class="simpara">For NodeJS (<a class="link" href="https://github.com/spring-cloud-samples/spring-cloud-contract-nodejs/tree/sc-pipelines" target="_top">example project</a>):</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">usage of <a class="link" href="https://www.npmjs.com/" target="_top">npm</a></li><li class="listitem"><code class="literal">npm install</code> is called to fetch libraries</li><li class="listitem"><code class="literal">npm test</code> is called to run tests</li><li class="listitem"><code class="literal">npm run group-id</code> npm task that echos the group id</li><li class="listitem"><code class="literal">npm run app-name</code> npm task that echos application name</li><li class="listitem"><code class="literal">npm run stub-ids</code> npm task that echos stub runner ids</li><li class="listitem"><code class="literal">npm run test-apicompatibility</code> npm task that is executed for api compatibility tests</li><li class="listitem"><code class="literal">npm run test-smoke</code> npm task that is executed for smoke testing</li><li class="listitem"><code class="literal">npm run test-e2e</code> npm task that is executed for end to end testing</li><li class="listitem"><code class="literal">target</code> is assumed to be the output folder. Put it to <code class="literal">.gitignore</code></li></ul></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_kubernetes_project_opinions" href="#_kubernetes_project_opinions"></a>4.2&nbsp;Kubernetes project opinions</h2></div></div></div><p>We&#8217;ve taken the following opinionated decisions for a Cloud Foundry based project:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">application built using Maven or Gradle wrappers</li><li class="listitem">application deployment to Kubernetes</li><li class="listitem">The produced Java Docker image needs to allow passing of system properties via <code class="literal">SYSTEM_PROPS</code> env variable</li><li class="listitem"><p class="simpara">For Maven (<a class="link" href="https://github.com/spring-cloud-samples/github-webhook-kubernetes" target="_top">example project</a>):</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">usage of Maven Wrapper</li><li class="listitem"><p class="simpara"><code class="literal">settings.xml</code> is parametrized to pass the credentials to push code to Artifactory and Docker repository</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><code class="literal">M2_SETTINGS_REPO_ID</code> - server id for Artifactory / Nexus deployment</li><li class="listitem"><code class="literal">M2_SETTINGS_REPO_USERNAME</code> - username for Artifactory / Nexus deployment</li><li class="listitem"><code class="literal">M2_SETTINGS_REPO_PASSWORD</code> - password for Artifactory / Nexus deployment</li><li class="listitem"><code class="literal">DOCKER_SERVER_ID</code> - server id for Docker image pushing</li><li class="listitem"><code class="literal">DOCKER_USERNAME</code> - username for Docker image pushing</li><li class="listitem"><code class="literal">DOCKER_PASSWORD</code> - password for Docker image pushing</li><li class="listitem"><code class="literal">DOCKER_EMAIL</code> - email for Artifactory / Nexus deployment</li></ul></div></li><li class="listitem"><code class="literal">DOCKER_REGISTRY_URL</code> env var - (Overridable - defaults to DockerHub) URL of the Docker registry</li><li class="listitem"><code class="literal">DOCKER_REGISTRY_ORGANIZATION</code> - env var containing the organization where your Docker repo lays</li><li class="listitem">artifacts and Docker image deployment by <code class="literal">./mvnw clean deploy</code></li><li class="listitem"><code class="literal">stubrunner.ids</code> property to retrieve list of collaborators for which stubs should be downloaded</li><li class="listitem"><code class="literal">repo.with.binaries</code> property - (Injected by the pipeline) will contain the URL to the repo containing binaries (e.g. Artifactory)</li><li class="listitem"><code class="literal">distribution.management.release.id</code> property - (Injected by the pipeline) ID of the distribution management. Corresponds to server id in <code class="literal">settings.xml</code></li><li class="listitem"><code class="literal">distribution.management.release.url</code> property - (Injected by the pipeline) Will contain the URL to the repo containing binaries (e.g. Artifactory)</li><li class="listitem"><code class="literal">deployment.yml</code> contains the Kubernetes deployment descriptor</li><li class="listitem"><code class="literal">service.yml</code> contains the Kubernetes service descriptor</li><li class="listitem">running API compatibility tests via the <code class="literal">apicompatibility</code> Maven profile</li><li class="listitem"><code class="literal">latest.production.version</code> property - (Injected by the pipeline) will contain the latest production version for the repo (retrieved from Git tags)</li><li class="listitem">running smoke tests on a deployed app via the <code class="literal">smoke</code> Maven profile</li><li class="listitem">running end to end tests on a deployed app via the <code class="literal">e2e</code> Maven profile</li></ul></div></li><li class="listitem"><p class="simpara">For Gradle  (<a class="link" href="https://github.com/spring-cloud-samples/github-analytics-kubernetes" target="_top">example project</a> check the <code class="literal">gradle/pipeline.gradle</code> file):</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">usage of Gradlew Wrapper</li><li class="listitem"><code class="literal">deploy</code> task for artifacts deployment</li><li class="listitem"><code class="literal">REPO_WITH_BINARIES_FOR_UPLOAD</code> env var - (Injected by the pipeline) will contain the URL to the repo containing binaries (e.g. Artifactory)</li><li class="listitem"><code class="literal">M2_SETTINGS_REPO_USERNAME</code> env var - Username used to send the binary to the repo containing binaries (e.g. Artifactory)</li><li class="listitem"><code class="literal">M2_SETTINGS_REPO_PASSWORD</code> env var - Password used to send the binary to the repo containing binaries (e.g. Artifactory)</li><li class="listitem"><code class="literal">DOCKER_REGISTRY_URL</code> env var - (Overridable - defaults to DockerHub) URL of the Docker registry</li><li class="listitem"><code class="literal">DOCKER_USERNAME</code> env var - Username used to send the the Docker image</li><li class="listitem"><code class="literal">DOCKER_PASSWORD</code> env var - Password used to send the the Docker image</li><li class="listitem"><code class="literal">DOCKER_EMAIL</code> env var - Email used to send the the Docker image</li><li class="listitem"><code class="literal">DOCKER_REGISTRY_ORGANIZATION</code> - env var containing the organization where your Docker repo lays</li><li class="listitem"><code class="literal">deployment.yml</code> contains the Kubernetes deployment descriptor</li><li class="listitem"><code class="literal">service.yml</code> contains the Kubernetes service descriptor</li><li class="listitem">running API compatibility tests via the <code class="literal">apiCompatibility</code> task</li><li class="listitem"><code class="literal">latestProductionVersion</code> property - (Injected by the pipeline) will contain the latest production version for the repo (retrieved from Git tags)</li><li class="listitem">running smoke tests on a deployed app via the <code class="literal">smoke</code> task</li><li class="listitem">running end to end tests on a deployed app via the <code class="literal">e2e</code> task</li><li class="listitem"><code class="literal">groupId</code> task to retrieve group id</li><li class="listitem"><code class="literal">artifactId</code> task to retrieve artifact id</li><li class="listitem"><code class="literal">currentVersion</code> task to retrieve the current version</li><li class="listitem"><code class="literal">stubIds</code> task to retrieve list of collaborators for which stubs should be downloaded</li></ul></div></li></ul></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="multi__opinionated_implementation.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="multi__customizing_the_project.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">3.&nbsp;Opinionated implementation&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="multi_spring-cloud-pipelines.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;5.&nbsp;Customizing the project</td></tr></table></div></body></html>