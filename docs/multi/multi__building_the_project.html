<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>15.&nbsp;Building the Project</title><link rel="stylesheet" type="text/css" href="css/manual-multipage.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="multi_spring-cloud-pipelines.html" title="Spring Cloud Pipelines"><link rel="up" href="multi__spring_cloud_pipelines.html" title="Part&nbsp;I.&nbsp;Spring Cloud Pipelines"><link rel="prev" href="multi__the_demo_setup_kubernetes.html" title="14.&nbsp;The demo setup (Kubernetes)"><link rel="next" href="multi__releasing_the_project.html" title="16.&nbsp;Releasing the Project"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">15.&nbsp;Building the Project</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="multi__the_demo_setup_kubernetes.html">Prev</a>&nbsp;</td><th width="60%" align="center">Part&nbsp;I.&nbsp;Spring Cloud Pipelines</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="multi__releasing_the_project.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="_building_the_project" href="#_building_the_project"></a>15.&nbsp;Building the Project</h2></div></div></div><p>This section covers how to build the project. It covers:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a class="xref" href="multi__building_the_project.html#building-project-setup" title="15.1&nbsp;Project Setup">Section&nbsp;15.1, &#8220;Project Setup&#8221;</a></li><li class="listitem"><a class="xref" href="multi__building_the_project.html#building-prerequisites" title="15.2&nbsp;Prerequisites">Section&nbsp;15.2, &#8220;Prerequisites&#8221;</a></li><li class="listitem"><a class="xref" href="multi__building_the_project.html#building-bats-submodules" title="15.3&nbsp;Bats Submodules">Section&nbsp;15.3, &#8220;Bats Submodules&#8221;</a></li><li class="listitem"><a class="xref" href="multi__building_the_project.html#building-build-and-test" title="15.4&nbsp;Build and test">Section&nbsp;15.4, &#8220;Build and test&#8221;</a></li><li class="listitem"><a class="xref" href="multi__building_the_project.html#building-generate-documentation" title="15.5&nbsp;Generate Documentation">Section&nbsp;15.5, &#8220;Generate Documentation&#8221;</a></li><li class="listitem"><a class="xref" href="multi__building_the_project.html#building-distributions" title="15.6&nbsp;Distributions">Section&nbsp;15.6, &#8220;Distributions&#8221;</a></li><li class="listitem"><a class="xref" href="multi__building_the_project.html#building-making-a-release" title="15.7&nbsp;Making a Release">Section&nbsp;15.7, &#8220;Making a Release&#8221;</a></li></ul></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="building-project-setup" href="#building-project-setup"></a>15.1&nbsp;Project Setup</h2></div></div></div><p>The following diagram shows the folder structure of Spring Cloud Pipelines:</p><div class="informalexample"><pre class="programlisting">.
&#9500;&#9472;&#9472; common
&#9500;&#9472;&#9472; concourse
&#9500;&#9472;&#9472; dist
&#9500;&#9472;&#9472; docs
&#9500;&#9472;&#9472; docs-sources
&#9492;&#9472;&#9472; jenkins</pre></div><p>In the <code class="literal">common</code> folder, you can find all the Bash scripts that contain the pipeline logic. These
scripts are reused by both the Concourse and Jenkins pipelines.</p><p>In the <code class="literal">concourse</code> folder, you can find all the necessary scripts and setup information to run the Concourse demo.</p><p>In the <code class="literal">dist</code> folder, you can find the packaged sources of the project. Since the package
contains no tests or documentation, it is extremely small and can be used in the pipelines.</p><p>In the <code class="literal">docs</code> folder, you can find the whole generated documentation of the project.</p><p>In the <code class="literal">docs-source</code> folder, you can find the sources required to generate the documentation.</p><p>In the <code class="literal">jenkins</code> folder, you can find all the necessary scripts and setup information to run the Jenkins demo.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="building-prerequisites" href="#building-prerequisites"></a>15.2&nbsp;Prerequisites</h2></div></div></div><p>As prerequisites, you need to have <a class="link" href="http://www.shellcheck.net/" target="_top">shellcheck</a>,
<a class="link" href="https://github.com/sstephenson/bats" target="_top">bats</a>, <a class="link" href="https://stedolan.github.io/jq/" target="_top">jq</a>
and <a class="link" href="https://rubyinstaller.org/downloads/" target="_top">ruby</a> installed. If you use a Linux
machine, <code class="literal">bats</code> and <code class="literal">shellcheck</code> are installed for you.</p><p>To install the required software on Linux, type the following command:</p><div class="informalexample"><pre class="programlisting">$ sudo apt-get install -y ruby jq</pre></div><p>If you use a Mac, run the following commands to install the missing software:</p><pre class="programlisting">$ brew install jq
$ brew install ruby
$ brew install bats
$ brew install shellcheck</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="building-bats-submodules" href="#building-bats-submodules"></a>15.3&nbsp;Bats Submodules</h2></div></div></div><p>To make <code class="literal">bats</code> work properly, we needed to attach Git submodules. To have them
initialized, either clone the project or (if you have already cloned the project)
pull to update it. The following command clones the project:</p><div class="informalexample"><pre class="programlisting">$ git clone --recursive https://github.com/spring-cloud/spring-cloud-pipelines.git</pre></div><p>The following commands pull the project:</p><div class="informalexample"><pre class="programlisting">$ git submodule init
$ git submodule update</pre></div><p>If you forget about this step, Gradle runs these steps for you.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="building-build-and-test" href="#building-build-and-test"></a>15.4&nbsp;Build and test</h2></div></div></div><p>Once you have installed all the prerequisites, you can run the following command to build and test the project:</p><div class="informalexample"><pre class="programlisting">$ ./gradlew clean build</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="building-generate-documentation" href="#building-generate-documentation"></a>15.5&nbsp;Generate Documentation</h2></div></div></div><p>To generate the documentation, run the following command:</p><div class="informalexample"><pre class="programlisting">$ ./gradlew generateDocs</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="building-distributions" href="#building-distributions"></a>15.6&nbsp;Distributions</h2></div></div></div><p>Spring Cloud Pipelines has a lot of tests, including Git repositories. Those
and the documentation &#8220;weigh&#8221; a lot. That is why, under the <code class="literal">dist</code> folder, we
publish <code class="literal">zip</code> and <code class="literal">tar.gz</code> distributions of the sources without tests and documentation.
Whenever we release a distribution, we attach a <code class="literal">VERSION</code> file to it that contains
build and SCM information (build time, revision number, and other details). To skip the
distribution generation pass the <code class="literal">skipDist</code> property on the command line, as follows:</p><div class="informalexample"><pre class="programlisting">$ ./gradlew build -PskipDist</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="building-making-a-release" href="#building-making-a-release"></a>15.7&nbsp;Making a Release</h2></div></div></div><p>You can run the <code class="literal">release</code> task to automatically test the project,
build the distributions, change the versions, build the docs, upload the docs to Spring Cloud Static,
tag the repo, and then revert the changed versions back to default. To do so, run the
following command:</p><div class="informalexample"><pre class="programlisting">$ ./gradlew release -PnewVersion=<span class="hl-number">1.0</span>.<span class="hl-number">0.</span>RELEASE</pre></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="multi__the_demo_setup_kubernetes.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="multi__spring_cloud_pipelines.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="multi__releasing_the_project.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">14.&nbsp;The demo setup (Kubernetes)&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="multi_spring-cloud-pipelines.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;16.&nbsp;Releasing the Project</td></tr></table></div></body></html>